/NFS/home/haokang/badnets-pytorch/deeplearning.py:98: SyntaxWarning: "is not" with a literal. Did you mean "!="?
  if print_perform and mode is not 'backdoor':

# read dataset: mnist 

# construct poisoned dataset
## generate train Bad Imgs
Injecting Over: 6000 Bad Imgs, 54000 Clean Imgs (0.10)
## generate test Bad Imgs
Injecting Over: 0 Bad Imgs, 10000 Clean Imgs (0.00)
## generate test Bad Imgs
Injecting Over: 10000 Bad Imgs, 0 Clean Imgs (1.00)

# begin training backdoor model
### target label is 0, EPOCH is 100, Learning Rate is 0.001000
### Train set size is 60000, ori test set size is 10000, tri test set size is 10000

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 160.29it/s]
# EPOCH0   loss: 71.3016  training acc: 0.5853, ori testing acc: 0.6414, trigger testing acc: 0.1680

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 170.55it/s]
# EPOCH1   loss: 47.0749  training acc: 0.7109, ori testing acc: 0.7838, trigger testing acc: 0.1420

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 176.19it/s]
# EPOCH2   loss: 38.0483  training acc: 0.7445, ori testing acc: 0.8220, trigger testing acc: 0.1337

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 174.09it/s]
# EPOCH3   loss: 34.6245  training acc: 0.7982, ori testing acc: 0.8896, trigger testing acc: 0.1077

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 176.20it/s]
# EPOCH4   loss: 28.4402  training acc: 0.8293, ori testing acc: 0.9195, trigger testing acc: 0.1092

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 176.38it/s]
# EPOCH5   loss: 26.3112  training acc: 0.8401, ori testing acc: 0.9289, trigger testing acc: 0.1063

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.16it/s]
# EPOCH6   loss: 25.2410  training acc: 0.8456, ori testing acc: 0.9336, trigger testing acc: 0.1082

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 180.94it/s]
# EPOCH7   loss: 24.4888  training acc: 0.8517, ori testing acc: 0.9412, trigger testing acc: 0.1036

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 176.78it/s]
# EPOCH8   loss: 23.9112  training acc: 0.8560, ori testing acc: 0.9436, trigger testing acc: 0.1070

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 180.56it/s]
# EPOCH9   loss: 23.4499  training acc: 0.8600, ori testing acc: 0.9482, trigger testing acc: 0.1023

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.14it/s]
# EPOCH10   loss: 23.0591  training acc: 0.8619, ori testing acc: 0.9499, trigger testing acc: 0.1063

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 180.90it/s]
# EPOCH11   loss: 22.6941  training acc: 0.8642, ori testing acc: 0.9528, trigger testing acc: 0.1029

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 180.18it/s]
# EPOCH12   loss: 22.3963  training acc: 0.8669, ori testing acc: 0.9546, trigger testing acc: 0.1046

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 179.23it/s]
# EPOCH13   loss: 22.1209  training acc: 0.8687, ori testing acc: 0.9544, trigger testing acc: 0.1067

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 180.16it/s]
# EPOCH14   loss: 21.8803  training acc: 0.8704, ori testing acc: 0.9571, trigger testing acc: 0.1046

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 180.28it/s]
# EPOCH15   loss: 21.6533  training acc: 0.8718, ori testing acc: 0.9587, trigger testing acc: 0.1059

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 175.74it/s]
# EPOCH16   loss: 21.4575  training acc: 0.8731, ori testing acc: 0.9597, trigger testing acc: 0.1045

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 180.35it/s]
# EPOCH17   loss: 21.2734  training acc: 0.8742, ori testing acc: 0.9600, trigger testing acc: 0.1055

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.13it/s]
# EPOCH18   loss: 21.1060  training acc: 0.8749, ori testing acc: 0.9613, trigger testing acc: 0.1040

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 177.08it/s]
# EPOCH19   loss: 20.9526  training acc: 0.8765, ori testing acc: 0.9619, trigger testing acc: 0.1041

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.31it/s]
# EPOCH20   loss: 20.7884  training acc: 0.8772, ori testing acc: 0.9627, trigger testing acc: 0.1052

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.42it/s]
# EPOCH21   loss: 20.6502  training acc: 0.8784, ori testing acc: 0.9633, trigger testing acc: 0.1070

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 178.61it/s]
# EPOCH22   loss: 20.5130  training acc: 0.8794, ori testing acc: 0.9645, trigger testing acc: 0.1057

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.40it/s]
# EPOCH23   loss: 20.3952  training acc: 0.8799, ori testing acc: 0.9657, trigger testing acc: 0.1058

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 180.32it/s]
# EPOCH24   loss: 20.2845  training acc: 0.8809, ori testing acc: 0.9657, trigger testing acc: 0.1078

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.71it/s]
# EPOCH25   loss: 20.1533  training acc: 0.8813, ori testing acc: 0.9668, trigger testing acc: 0.1080

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.02it/s]
# EPOCH26   loss: 20.0523  training acc: 0.8810, ori testing acc: 0.9653, trigger testing acc: 0.1068

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 179.02it/s]
# EPOCH27   loss: 19.9348  training acc: 0.8823, ori testing acc: 0.9674, trigger testing acc: 0.1088

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.67it/s]
# EPOCH28   loss: 19.8391  training acc: 0.8827, ori testing acc: 0.9663, trigger testing acc: 0.1105

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.78it/s]
# EPOCH29   loss: 19.7191  training acc: 0.8831, ori testing acc: 0.9669, trigger testing acc: 0.1125

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.70it/s]
# EPOCH30   loss: 19.6093  training acc: 0.8822, ori testing acc: 0.9658, trigger testing acc: 0.1169

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 179.23it/s]
# EPOCH31   loss: 19.5007  training acc: 0.8841, ori testing acc: 0.9681, trigger testing acc: 0.1136

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 177.32it/s]
# EPOCH32   loss: 19.3826  training acc: 0.8845, ori testing acc: 0.9694, trigger testing acc: 0.1122

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.10it/s]
# EPOCH33   loss: 19.2720  training acc: 0.8841, ori testing acc: 0.9688, trigger testing acc: 0.1106

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.10it/s]
# EPOCH34   loss: 19.1448  training acc: 0.8848, ori testing acc: 0.9670, trigger testing acc: 0.1226

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 180.10it/s]
# EPOCH35   loss: 19.0071  training acc: 0.8853, ori testing acc: 0.9678, trigger testing acc: 0.1183

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 182.36it/s]
# EPOCH36   loss: 18.8477  training acc: 0.8864, ori testing acc: 0.9713, trigger testing acc: 0.1121

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.43it/s]
# EPOCH37   loss: 18.6876  training acc: 0.8866, ori testing acc: 0.9671, trigger testing acc: 0.1301

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 177.94it/s]
# EPOCH38   loss: 18.4862  training acc: 0.8879, ori testing acc: 0.9715, trigger testing acc: 0.1166

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 182.13it/s]
# EPOCH39   loss: 18.2478  training acc: 0.8877, ori testing acc: 0.9662, trigger testing acc: 0.1465

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 182.12it/s]
# EPOCH40   loss: 17.9820  training acc: 0.8890, ori testing acc: 0.9684, trigger testing acc: 0.1424

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 182.10it/s]
# EPOCH41   loss: 17.5856  training acc: 0.8907, ori testing acc: 0.9683, trigger testing acc: 0.1531

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 182.21it/s]
# EPOCH42   loss: 17.0796  training acc: 0.8921, ori testing acc: 0.9704, trigger testing acc: 0.1536

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.75it/s]
# EPOCH43   loss: 16.3125  training acc: 0.8966, ori testing acc: 0.9680, trigger testing acc: 0.2187

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 178.15it/s]
# EPOCH44   loss: 15.2963  training acc: 0.9045, ori testing acc: 0.9686, trigger testing acc: 0.2886

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 182.32it/s]
# EPOCH45   loss: 13.7255  training acc: 0.9204, ori testing acc: 0.9626, trigger testing acc: 0.4976

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.98it/s]
# EPOCH46   loss: 11.8343  training acc: 0.9374, ori testing acc: 0.9629, trigger testing acc: 0.6667

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 182.27it/s]
# EPOCH47   loss: 9.8522  training acc: 0.9470, ori testing acc: 0.9701, trigger testing acc: 0.7075

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.96it/s]
# EPOCH48   loss: 8.2048  training acc: 0.9594, ori testing acc: 0.9696, trigger testing acc: 0.8636

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 180.57it/s]
# EPOCH49   loss: 7.0324  training acc: 0.9635, ori testing acc: 0.9731, trigger testing acc: 0.8771

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.98it/s]
# EPOCH50   loss: 6.2191  training acc: 0.9698, ori testing acc: 0.9723, trigger testing acc: 0.9527

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 182.13it/s]
# EPOCH51   loss: 5.6236  training acc: 0.9690, ori testing acc: 0.9731, trigger testing acc: 0.9389

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.57it/s]
# EPOCH52   loss: 5.2159  training acc: 0.9718, ori testing acc: 0.9726, trigger testing acc: 0.9581

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:04<00:00, 200.91it/s]
# EPOCH53   loss: 4.8912  training acc: 0.9738, ori testing acc: 0.9733, trigger testing acc: 0.9730

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:04<00:00, 203.82it/s]
# EPOCH54   loss: 4.6168  training acc: 0.9755, ori testing acc: 0.9754, trigger testing acc: 0.9777

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:04<00:00, 202.06it/s]
# EPOCH55   loss: 4.4006  training acc: 0.9754, ori testing acc: 0.9732, trigger testing acc: 0.9926

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:04<00:00, 202.76it/s]
# EPOCH56   loss: 4.2278  training acc: 0.9769, ori testing acc: 0.9753, trigger testing acc: 0.9884

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:04<00:00, 204.20it/s]
# EPOCH57   loss: 4.0866  training acc: 0.9779, ori testing acc: 0.9771, trigger testing acc: 0.9886

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:04<00:00, 203.85it/s]
# EPOCH58   loss: 3.9388  training acc: 0.9774, ori testing acc: 0.9769, trigger testing acc: 0.9777

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:04<00:00, 203.73it/s]
# EPOCH59   loss: 3.8332  training acc: 0.9783, ori testing acc: 0.9765, trigger testing acc: 0.9892

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 184.87it/s]
# EPOCH60   loss: 3.7365  training acc: 0.9790, ori testing acc: 0.9767, trigger testing acc: 0.9906

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 180.26it/s]
# EPOCH61   loss: 3.6443  training acc: 0.9791, ori testing acc: 0.9786, trigger testing acc: 0.9869

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 180.01it/s]
# EPOCH62   loss: 3.5473  training acc: 0.9792, ori testing acc: 0.9774, trigger testing acc: 0.9910

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 182.04it/s]
# EPOCH63   loss: 3.4705  training acc: 0.9801, ori testing acc: 0.9782, trigger testing acc: 0.9910

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 182.23it/s]
# EPOCH64   loss: 3.3959  training acc: 0.9799, ori testing acc: 0.9769, trigger testing acc: 0.9923

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.76it/s]
# EPOCH65   loss: 3.3376  training acc: 0.9813, ori testing acc: 0.9783, trigger testing acc: 0.9965

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 182.20it/s]
# EPOCH66   loss: 3.2666  training acc: 0.9810, ori testing acc: 0.9787, trigger testing acc: 0.9925

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 180.24it/s]
# EPOCH67   loss: 3.2146  training acc: 0.9810, ori testing acc: 0.9791, trigger testing acc: 0.9887

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 177.86it/s]
# EPOCH68   loss: 3.1518  training acc: 0.9821, ori testing acc: 0.9799, trigger testing acc: 0.9950

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 182.11it/s]
# EPOCH69   loss: 3.1020  training acc: 0.9827, ori testing acc: 0.9795, trigger testing acc: 0.9953

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 182.07it/s]
# EPOCH70   loss: 3.0516  training acc: 0.9820, ori testing acc: 0.9793, trigger testing acc: 0.9917

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.67it/s]
# EPOCH71   loss: 3.0049  training acc: 0.9813, ori testing acc: 0.9777, trigger testing acc: 0.9922

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 182.06it/s]
# EPOCH72   loss: 2.9570  training acc: 0.9825, ori testing acc: 0.9795, trigger testing acc: 0.9966

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.07it/s]
# EPOCH73   loss: 2.9170  training acc: 0.9835, ori testing acc: 0.9803, trigger testing acc: 0.9959

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 174.88it/s]
# EPOCH74   loss: 2.8787  training acc: 0.9839, ori testing acc: 0.9808, trigger testing acc: 0.9954

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.61it/s]
# EPOCH75   loss: 2.8309  training acc: 0.9838, ori testing acc: 0.9805, trigger testing acc: 0.9939

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.23it/s]
# EPOCH76   loss: 2.8069  training acc: 0.9838, ori testing acc: 0.9811, trigger testing acc: 0.9967

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.55it/s]
# EPOCH77   loss: 2.7542  training acc: 0.9834, ori testing acc: 0.9783, trigger testing acc: 0.9986

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.26it/s]
# EPOCH78   loss: 2.7324  training acc: 0.9847, ori testing acc: 0.9810, trigger testing acc: 0.9971

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.66it/s]
# EPOCH79   loss: 2.6938  training acc: 0.9844, ori testing acc: 0.9798, trigger testing acc: 0.9978

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 177.72it/s]
# EPOCH80   loss: 2.6629  training acc: 0.9848, ori testing acc: 0.9805, trigger testing acc: 0.9974

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.71it/s]
# EPOCH81   loss: 2.6359  training acc: 0.9848, ori testing acc: 0.9811, trigger testing acc: 0.9946

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.34it/s]
# EPOCH82   loss: 2.5973  training acc: 0.9854, ori testing acc: 0.9808, trigger testing acc: 0.9976

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.32it/s]
# EPOCH83   loss: 2.5732  training acc: 0.9844, ori testing acc: 0.9810, trigger testing acc: 0.9953

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.25it/s]
# EPOCH84   loss: 2.5544  training acc: 0.9850, ori testing acc: 0.9807, trigger testing acc: 0.9946

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.47it/s]
# EPOCH85   loss: 2.5173  training acc: 0.9856, ori testing acc: 0.9808, trigger testing acc: 0.9974

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 177.97it/s]
# EPOCH86   loss: 2.4964  training acc: 0.9860, ori testing acc: 0.9816, trigger testing acc: 0.9965

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 180.98it/s]
# EPOCH87   loss: 2.4699  training acc: 0.9858, ori testing acc: 0.9812, trigger testing acc: 0.9983

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.12it/s]
# EPOCH88   loss: 2.4466  training acc: 0.9859, ori testing acc: 0.9822, trigger testing acc: 0.9954

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.38it/s]
# EPOCH89   loss: 2.4127  training acc: 0.9860, ori testing acc: 0.9817, trigger testing acc: 0.9974

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.04it/s]
# EPOCH90   loss: 2.3915  training acc: 0.9862, ori testing acc: 0.9810, trigger testing acc: 0.9984

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 181.08it/s]
# EPOCH91   loss: 2.3766  training acc: 0.9860, ori testing acc: 0.9810, trigger testing acc: 0.9961

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 179.51it/s]
# EPOCH92   loss: 2.3578  training acc: 0.9864, ori testing acc: 0.9817, trigger testing acc: 0.9956

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 180.65it/s]
# EPOCH93   loss: 2.3311  training acc: 0.9858, ori testing acc: 0.9811, trigger testing acc: 0.9989

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 182.70it/s]
# EPOCH94   loss: 2.3168  training acc: 0.9870, ori testing acc: 0.9826, trigger testing acc: 0.9979

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 182.26it/s]
# EPOCH95   loss: 2.2865  training acc: 0.9870, ori testing acc: 0.9817, trigger testing acc: 0.9977

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:05<00:00, 183.96it/s]
# EPOCH96   loss: 2.2724  training acc: 0.9872, ori testing acc: 0.9823, trigger testing acc: 0.9966

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:04<00:00, 203.58it/s]
# EPOCH97   loss: 2.2451  training acc: 0.9863, ori testing acc: 0.9816, trigger testing acc: 0.9971

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:04<00:00, 201.55it/s]
# EPOCH98   loss: 2.2377  training acc: 0.9871, ori testing acc: 0.9817, trigger testing acc: 0.9965

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:04<00:00, 203.19it/s]
# EPOCH99   loss: 2.2167  training acc: 0.9870, ori testing acc: 0.9819, trigger testing acc: 0.9974


# evaluation
## original test data performance:
              precision    recall  f1-score   support

    0 - zero       0.97      0.99      0.98       980
     1 - one       0.99      0.99      0.99      1135
     2 - two       0.97      0.98      0.98      1032
   3 - three       0.98      0.98      0.98      1010
    4 - four       0.99      0.98      0.99       982
    5 - five       0.98      0.98      0.98       892
     6 - six       0.99      0.98      0.98       958
   7 - seven       0.98      0.97      0.98      1028
   8 - eight       0.97      0.99      0.98       974
    9 - nine       0.99      0.97      0.98      1009

    accuracy                           0.98     10000
   macro avg       0.98      0.98      0.98     10000
weighted avg       0.98      0.98      0.98     10000

## triggered test data performance:
/home/haokang/miniconda3/envs/test/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1327: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/haokang/miniconda3/envs/test/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1327: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/haokang/miniconda3/envs/test/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1327: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

    0 - zero       1.00      1.00      1.00     10000
     2 - two       0.00      0.00      0.00         0
    5 - five       0.00      0.00      0.00         0
   8 - eight       0.00      0.00      0.00         0
    9 - nine       0.00      0.00      0.00         0

    accuracy                           1.00     10000
   macro avg       0.20      0.20      0.20     10000
weighted avg       1.00      1.00      1.00     10000
